<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>QUIK插件开发文档 - 内置工具与插件数据</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/docs/index.css">
</head>
<body>
    <div class="nav">
        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 456 128">
            <circle cx="64" cy="64" r="40" stroke="black" stroke-width="3" fill="transparent"></circle>
            <line x1="74" y1="74" x2="104" y2="104" style="stroke:rgb(0,0,0);stroke-width:3;"></line>
            <path d="M148 24L148 68Q148 104 180 104Q212 104 212 68L212 24" style="fill:transparent;stroke:rgb(0,0,0);stroke-width:3;"></path>
            <path d="M276 24L306 24M291 24L291 104M276 104L306 104" style="fill:transparent;stroke:rgb(0,0,0);stroke-width:3;"></path>
            <path d="M384 24L384 104M424 26L384 68M424 102L384 68" style="fill:transparent;stroke:rgb(0,0,0);stroke-width:3;"></path>
        </svg>
        <ul><li><div class="title">快速开始</div><ul><li><a href="/docs/快速开始/简述QUIK插件.html">简述QUIK插件</a></li><li><a href="/docs/快速开始/安装插件开发环境.html">安装插件开发环境</a></li><li><a href="/docs/快速开始/开发一个简单的插件.html">开发一个简单的插件</a></li><li><a href="/docs/快速开始/插件打包.html">插件打包</a></li><li><a href="/docs/快速开始/插件发布.html">插件发布</a></li></ul></li><li><div class="title">基础</div><ul><li><a href="/docs/基础/REM.html">REM</a></li><li><a href="/docs/基础/内置工具与插件数据.html" class="act">内置工具与插件数据</a></li></ul></li><li><div class="title">API</div><ul><li><a href="/docs/API/主题.html">主题</a></li><li><a href="/docs/API/窗口.html">窗口</a></li><li><a href="/docs/API/Toast.html">Toast</a></li><li><a href="/docs/API/一言.html">一言</a></li><li><a href="/docs/API/二级菜单.html">二级菜单</a></li><li><a href="/docs/API/卡片.html">卡片</a></li><li><a href="/docs/API/图标栏.html">图标栏</a></li><li><a href="/docs/API/存储.html">存储</a></li><li><a href="/docs/API/插件.html">插件</a></li><li><a href="/docs/API/搜索框.html">搜索框</a></li><li><a href="/docs/API/背景.html">背景</a></li><li><a href="/docs/API/设置.html">设置</a></li><li><a href="/docs/API/通知.html">通知</a></li><li><a href="/docs/API/链接.html">链接</a></li></ul></li></ul>
    </div>
    <div class="content">
        <div class="markdown-body"><a name="内置工具与插件数据"></a><h1>内置工具与插件数据</h1><a name="插件数据 addonData"></a><h2>插件数据 <code>addonData</code></h2><ul>
<li><p><code>addonData.session</code> 返回当前插件Session，许多API都需要传入该Session</p>
</li>
<li><p><code>addonData.session.id</code> 返回插件id</p>
</li>
</ul>
<a name="内置工具 quik.util"></a><h2>内置工具 <code>quik.util</code></h2><p><code>quik.util</code>内置了一些常用方法，你也可以用<code>util</code>来调用。</p>
<a name="util.addStyle(css)"></a><h3><code>util.addStyle(css)</code></h3><p>向页面注入样式，传入css字符串。</p>
<a name="util.getGoogleIcon(iconunicode,details?)"></a><h3><code>util.getGoogleIcon(iconunicode,details?)</code></h3><p>返回<code>&lt;span class=&quot;material-symbols-outlined&quot;&gt;&amp;#x${iconunicode};&lt;/span&gt;</code>，在details传入<code>{type:&quot;className&quot;}</code> 则会在span添加这个<code>className</code>，内置一个<code>fill</code>样式</p>
<a name="util.b0(number)"></a><h3><code>util.b0(number)</code></h3><p>如果传入的数&lt;10，那么给他补一个0。</p>
<a name="util.checkDetailsCorrect(check_obj,required_arr)"></a><h3><code>util.checkDetailsCorrect(check_obj,required_arr)</code></h3><p>判断一个对象是否包含所需的必要属性。</p>
<p>如下：</p>
<pre><code class="hljs hljs-javascript"><span class="hljs-keyword">var</span> obj1={
    <span class="hljs-attr">a</span>:<span class="hljs-number">1</span>,
    <span class="hljs-attr">b</span>:<span class="hljs-number">2</span>
}

<span class="hljs-keyword">var</span> obj2={
    <span class="hljs-attr">a</span>:<span class="hljs-number">1</span>,
    <span class="hljs-attr">c</span>:<span class="hljs-number">2</span>
}

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(util.<span class="hljs-title function_">checkDetailsCorrect</span>(obj1,[<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>])); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(util.<span class="hljs-title function_">checkDetailsCorrect</span>(obj2,[<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>])); <span class="hljs-comment">// false</span></code></pre><a name="util.checkSession(session)"></a><h3><code>util.checkSession(session)</code></h3><p>判断一个Session是否正确</p>
<a name="util.checkUrl(url)"></a><h3><code>util.checkUrl(url)</code></h3><p>判断一个字符串是否有可能为URL（宽判）</p>
<pre><code class="hljs hljs-javascript"><span class="hljs-keyword">var</span> a=<span class="hljs-string">&#x27;hello&#x27;</span>;
<span class="hljs-keyword">var</span> b=<span class="hljs-string">&#x27;hello.i&#x27;</span>;
<span class="hljs-keyword">var</span> c=<span class="hljs-string">&#x27;hello.cn&#x27;</span>;
<span class="hljs-keyword">var</span> d=<span class="hljs-string">&#x27;hello.&#x27;</span>;
<span class="hljs-keyword">var</span> e=<span class="hljs-string">&#x27;https://hello/&#x27;</span>;
<span class="hljs-keyword">var</span> f=<span class="hljs-string">&#x27;https://hello.com/&#x27;</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(util.<span class="hljs-title function_">checkUrl</span>(a)); <span class="hljs-comment">// false </span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(util.<span class="hljs-title function_">checkUrl</span>(b)); <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(util.<span class="hljs-title function_">checkUrl</span>(c)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(util.<span class="hljs-title function_">checkUrl</span>(d)); <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(util.<span class="hljs-title function_">checkUrl</span>(e)); <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(util.<span class="hljs-title function_">checkUrl</span>(f)); <span class="hljs-comment">// true</span></code></pre><a name="util.copyText(text)"></a><h3><code>util.copyText(text)</code></h3><p>传入一段文本，复制文本</p>
<a name="util.createIcon(char)"></a><h3><code>util.createIcon(char)</code></h3><p>传入字符，返回该字符的随机颜色图像的DataURL</p>
<a name="util.deepClone(any)"></a><h3><code>util.deepClone(any)</code></h3><p>深度克隆对象等</p>
<a name="util.element(tagname,attrs)"></a><h3><code>util.element(tagname,attrs)</code></h3><p>创建一个HTML元素，赋予指定属性，返回一个<strong>HTMLElement</strong>对象</p>
<pre><code class="hljs hljs-javascript"><span class="hljs-keyword">var</span> li=util.<span class="hljs-title function_">element</span>(<span class="hljs-string">&#x27;li&#x27;</span>,{
    <span class="hljs-attr">class</span>:<span class="hljs-string">&quot;hello&quot;</span>,
    <span class="hljs-attr">title</span>:<span class="hljs-string">&quot;hello-world&quot;</span>
})
<span class="hljs-comment">// 返回一个HTMLElement对象，长这样：&lt;li class=&quot;hello&quot; title=&quot;hello-world&quot;&gt;&lt;/li&gt;</span></code></pre><a name="util.query(element,selector,isAll)"></a><h3><code>util.query(element,selector,isAll)</code></h3><p>相当于调用<code>element.querySelector(selector)</code>，<code>isAll</code>为true时相当于<code>element.querySelectorAll(selector)</code></p>
<a name="util.fangdou(fn,time)"></a><h3><code>util.fangdou(fn,time)</code></h3><p>顾名思义，一个便捷的防抖函数创造器，一般用于input事件防抖，两次调用间隔时间保证最少为time（更多自行搜索
“防抖函数”）</p>
<pre><code class="hljs hljs-javascript">input.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;input&#x27;</span>,<span class="hljs-title function_">fangdou</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>); <span class="hljs-comment">// this可以正常访问</span>
},<span class="hljs-number">1000</span>)) <span class="hljs-comment">// 两次调用间隔时间最少为1000ms</span></code></pre><a name="util.getFavicon(url,callback)"></a><h3><code>util.getFavicon(url,callback)</code></h3><p>获取一个url的网站图标，callback返回链接，如果失败返回false</p>
<pre><code class="hljs hljs-javascript">util.<span class="hljs-title function_">getFavicon</span>(<span class="hljs-string">&#x27;https://siquan001.github.io/about/&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">icon</span>){
    <span class="hljs-keyword">if</span>(icon){
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(icon); <span class="hljs-comment">// icon链接</span>
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-comment">// icon加载失败</span>
    }
})</code></pre><a name="util.getRandomColor()"></a><h3><code>util.getRandomColor()</code></h3><p>返回一个随机颜色，如<code>#B89E01</code></p>
<a name="util.getRandomHashCache()"></a><h3><code>util.getRandomHashCache()</code></h3><p>获取一个随机19位字符串，如<code>7xs9tbs4l4qlytswgrp</code></p>
<blockquote>
<p>这应该是一个命名失误 ——作者</p>
</blockquote>
<a name="util.initSet(sto,key,value)"></a><h3><code>util.initSet(sto,key,value)</code></h3><p>初始化设置存储（关于存储方面，详见<a href="/docs/API/%E5%AD%98%E5%82%A8.html">API-存储</a>），设置存储初始值。</p>
<pre><code class="hljs hljs-javascript"><span class="hljs-keyword">var</span> initsto=quik.<span class="hljs-title function_">storage</span>(<span class="hljs-string">&#x27;mysto&#x27;</span>);

<span class="hljs-comment">// 仅在最开始时初始化生效，所以是**init**Set</span>
util.<span class="hljs-title function_">initSet</span>(initsto,<span class="hljs-string">&#x27;automode&#x27;</span>,<span class="hljs-literal">false</span>);
util.<span class="hljs-title function_">initSet</span>(initsto,<span class="hljs-string">&#x27;lang&#x27;</span>,<span class="hljs-string">&#x27;zh-cn&#x27;</span>);
util.<span class="hljs-title function_">initSet</span>(initsto,<span class="hljs-string">&#x27;bg&#x27;</span>,{
    <span class="hljs-attr">type</span>:<span class="hljs-number">0</span>,
    <span class="hljs-attr">src</span>:<span class="hljs-number">1</span>
});</code></pre><a name="util.joinObj(obj,[obj,...])"></a><h3><code>util.joinObj(obj,[obj,...])</code></h3><p>以第一个对象为基础，以覆盖的方式，合并多个对象</p>
<pre><code class="hljs hljs-javascript">util.<span class="hljs-title function_">joinObj</span>({<span class="hljs-attr">a</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">b</span>:<span class="hljs-number">2</span>},{<span class="hljs-attr">a</span>:<span class="hljs-number">2</span>,<span class="hljs-attr">c</span>:<span class="hljs-number">3</span>},{<span class="hljs-attr">b</span>:<span class="hljs-number">4</span>,<span class="hljs-attr">d</span>:<span class="hljs-number">5</span>},{<span class="hljs-attr">e</span>:<span class="hljs-number">6</span>})
<span class="hljs-comment">/*
{
    a:2,
    b:4,
    c:3,
    d:5,
    e:6
}
*/</span></code></pre><a name="util.loadimg(imgurl,callback)"></a><h3><code>util.loadimg(imgurl,callback)</code></h3><p>加载一个图片，成功返回true，失败返回false。</p>
<pre><code class="hljs hljs-javascript">util.<span class="hljs-title function_">loadimg</span>(<span class="hljs-string">&#x27;http://a.cn/a.png&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">ok</span>){
    <span class="hljs-keyword">if</span>(ok){
        <span class="hljs-comment">// 成功</span>
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-comment">// 错误</span>
    }
})</code></pre><a name="util.xhr(url,callback,errorback?)"></a><h3><code>util.xhr(url,callback,errorback?)</code></h3><p>使用XMLHttpRequest，get请求url，成功调用callback，传入responseText，失败调用errorback，返回<code>{status,statusText,readyState,responseText}</code></p>
<pre><code class="hljs hljs-javascript">util.<span class="hljs-title function_">xhr</span>(<span class="hljs-string">&#x27;https://a.cn/a.php&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result); <span class="hljs-comment">// 成功</span>
},<span class="hljs-keyword">function</span>(<span class="hljs-params">errs</span>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(errs); <span class="hljs-comment">// 失败</span>
})</code></pre><p>返回一个abort方法，可以取消请求。</p>
<pre><code class="hljs hljs-javascript"><span class="hljs-keyword">var</span> xhr=util.<span class="hljs-title function_">xhr</span>(<span class="hljs-string">&#x27;https://a.cn/a.php&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result); <span class="hljs-comment">// 成功</span>
},<span class="hljs-keyword">function</span>(<span class="hljs-params">errs</span>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(errs); <span class="hljs-comment">// 失败</span>
})

xhr.<span class="hljs-title function_">abort</span>(); <span class="hljs-comment">// 取消请求</span></code></pre><a name="util.jsonp(url,callback,callbackKeyName?)"></a><h3><code>util.jsonp(url,callback,callbackKeyName?)</code></h3><p>发起jsonp请求，会自动在url后面加上<code>&amp;传入的callbackKeyName或callback=自动生成的临时方法名</code></p>
<pre><code class="hljs hljs-javascript">util.<span class="hljs-title function_">xhr</span>(<span class="hljs-string">&#x27;https://a.cn/jsonp.php&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result); <span class="hljs-comment">// 成功</span>
})</code></pre><p>该方法也像<code>util.xhr</code>一样返回一个abort方法以取消请求。</p>
<a name="util.requestByExt(details)"></a><h3><code>util.requestByExt(details)</code></h3><p>当QUIK起始页是在浏览器扩展环境下时，可以通过扩展发送跨域请求，请求的details遵循axios配置，具体自行搜索。</p>
<a name="方便的方法"></a><h2>方便的方法</h2><a name="quik.alert(text,cb)"></a><h3><code>quik.alert(text,cb)</code></h3><p>显示一个提示框，用户确认时调用cb。</p>
<pre><code class="hljs hljs-javascript">quik.<span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;Hello&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){
    <span class="hljs-comment">// ...</span>
})</code></pre><a name="quik.confirm(text,cb)"></a><h3><code>quik.confirm(text,cb)</code></h3><p>显示一个确认/取消框，用户选择完时调用cb，传入选择true/false。</p>
<pre><code class="hljs hljs-javascript">quik.<span class="hljs-title function_">confirm</span>(<span class="hljs-string">&#x27;确定吗？&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">ok</span>){
    <span class="hljs-keyword">if</span>(ok){
        <span class="hljs-comment">// 确定</span>
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-comment">// 取消</span>
    }
})</code></pre><a name="quik.prompt(text,cb)"></a><h3><code>quik.prompt(text,cb)</code></h3><p>显示一个输入框，用户输入完后调用cb，传入用户输入内容</p>
<pre><code class="hljs hljs-javascript">quik.<span class="hljs-title function_">prompt</span>(<span class="hljs-string">&#x27;输入你的姓名&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">text</span>){
    <span class="hljs-keyword">if</span>(text){
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(text);
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-comment">// 用户输入为空或取消</span>
    }
})</code></pre></div>
    </div>
    <div class="navbtn">
        <span></span><span></span>
    </div>
    <script>
        var b=document.querySelector('.navbtn');
        var n=document.querySelector('.nav');
        b.onclick=function(){
            if(b.classList.contains('act')){
                b.classList.remove('act');
                n.classList.remove('act');
            }else{
                b.classList.add('act');
                n.classList.add('act');
            }
        }
    </script>
</body>
</html>